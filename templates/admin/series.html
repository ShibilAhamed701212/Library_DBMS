{% extends "layout.html" %}

{% block title %}Manage Book Series{% endblock %}
{% block header_title %}Series Collections{% endblock %}
{% block header_subtitle %}Organize your library collections into chronological sagas.{% endblock %}

{% block content %}
<style>
    .series-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1.5rem;
    }
    .series-card {
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        transition: transform 0.3s;
        border-left: 4px solid var(--primary);
    }
    .series-card:hover { transform: translateY(-5px); }
    .book-count {
        font-size: 0.8rem;
        color: var(--text-sub);
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
</style>

<div class="series-grid">
    {% if not series_list %}
    <div class="glass-card" style="grid-column: 1/-1; padding: 3rem; text-align: center;">
        <div style="font-size: 3rem; margin-bottom: 1rem;">üìö</div>
        <h3>No Series Detected</h3>
        <p style="color: var(--text-sub);">The AI will automatically group books into series as you add them.</p>
    </div>
    {% else %}
    {% for s in series_list %}
    <div class="glass-card series-card">
        <h3 style="margin: 0; color: var(--text-main);">{{ s.title }}</h3>
        <span class="book-count">üìñ {{ s.book_count }} Books in Collection</span>
        <p style="font-size: 0.9rem; color: var(--text-sub); margin: 0.5rem 0;">{{ s.description or 'Automatic collection grouped by the intelligent system.' }}</p>
        
        <div style="margin-top: auto; padding-top: 1rem;">
            <a href="/admin/series/{{ s.series_id }}" class="btn btn-primary btn-block" style="text-align: center; text-decoration: none; display: block;">üîç View Full Series</a>
        </div>
    </div>
    {% endfor %}
    {% endif %}
</div>

<!-- Create Series Modal -->
<div class="fab-container" style="position: fixed; bottom: 30px; right: 30px; z-index: 1000;">
    <button class="btn btn-primary btn-lg rounded-circle shadow" onclick="openModal('createSeriesModal')" 
            style="width: 65px; height: 65px; font-size: 2rem; display: flex; align-items: center; justify-content: center; transition: transform 0.2s;">
        <span>+</span>
    </button>
</div>

<div id="createSeriesModal" class="modal-overlay">
    <div class="modal-content glass-card">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h2>Create New Series</h2>
            <button class="btn-close" onclick="closeModal('createSeriesModal')">‚úï</button>
        </div>
        <form action="/admin/series/create" method="POST">
            <div class="form-group">
                <label>Series Name</label>
                <input type="text" name="name" class="form-control" required placeholder="e.g. Harry Potter">
            </div>
            <div class="form-group" style="margin-top: 1rem;">
                <label>Description (Optional)</label>
                <textarea name="description" class="form-control" placeholder="A brief description of this saga..."></textarea>
            </div>
            <div style="margin-top: 1.5rem; text-align: right;">
                <button type="submit" class="btn btn-primary">Create Series</button>
            </div>
        </form>
    </div>
</div>

<script>
    function openModal(id) { document.getElementById(id).style.display = "flex"; }
    function closeModal(id) { document.getElementById(id).style.display = "none"; }
</script>
{% endblock %}
